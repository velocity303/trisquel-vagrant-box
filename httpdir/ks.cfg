#Generated by Kickstart Configurator
#platform=AMD64 or Intel EM64T

#System language
lang en_US
#Language modules to install
langsupport en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone --utc America/Chicago
#Root password
rootpw --disabled
#Initial user
user vagrant --fullname "vagrant" --iscrypted --password $1$hkLoj6ge$fyQSYJ5k//OW2rtlytM5n0
#Reboot after installation
reboot
#Use text mode install
text
#Install OS instead of upgrade
install
#Use CDROM installation media
cdrom
#System bootloader configuration
bootloader --location=mbr 
#Clear the Master Boot Record
zerombr yes
#Partition clearing information
clearpart --all --initlabel
part swap --recommended
part /boot --fstype ext2 --size 300
part /     --fstype ext4 --size 1 --grow
#System authorization infomation
auth  --useshadow  --enablemd5 
#Network information
network --bootproto dhcp --device eth0 --hostname trisquel7
#Firewall configuration
firewall --disabled 

%packages
@ openssh-server
%end
#Do not configure the X Window System
skipx

%post --interpreter /bin/bash

ln -s /dev/null /etc/udev/rule.d/70-persistent-net.rules

echo 'vagrant ALL=NOPASSWD:ALL' > /etc/sudoers.d/vagrant

mkdir -p /home/vagrant/.ssh

cat <<EOK >/home/vagrant/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA6NF8iallvQVp22WDkTkyrtvp9eWW6A8Y\
Vr+kz4TjGYe7gHzIw+niNltGEFHzD8+v1I2YJ6oXevct1YeS0o9HZyN1Q9qgCgzUFtdO\
KLv6IedplqoPkcmF0aYet2PkEDo3MlTBckFXPITAMzF8dJSIFo9D8HfdOV0IAdx4O7Pt\
ixWKn5y2hMNG0zQPyUecp4pzC6kivAIhyfHilFR61RGL+GPXQ2MWZWFYbAGjyiYJnAmC\
P3NOTd0jMZEnDkbUvxhMmBYSdETk1rRgm+R4LOzFUGaHqHDLKLX+FIPKcF96hrucXzcW\
yLbIbEgE98OHlnVYCzRdK8jlqm8tehUc9c9WhQ== vagrant insecure public key
EOK

chown -R 1000:1000 /home/vagrant/.ssh
chmod 700 /home/vagrant/.ssh
chmod 0600 /home/vagrant/.ssh/authorized_keys
%end
